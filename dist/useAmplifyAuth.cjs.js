"use strict";var r=require("react"),e=require("aws-amplify");const t=(r,e)=>{switch(e.type){case"FETCH_USER_DATA_INIT":return{...r,isLoading:!0,isError:!1};case"FETCH_USER_DATA_SUCCESS":return{...r,isLoading:!1,isError:!1,user:e.payload.user};case"FETCH_USER_DATA_FAILURE":return{...r,isLoading:!1,isError:!0};case"RESET_USER_DATA":return{...r,user:null};default:throw new Error}};module.exports=()=>{const[s,a]=r.useReducer(t,{isLoading:!0,isError:!1,user:null}),[u,n]=r.useState(!1);r.useEffect(()=>{let r=!0;return e.Hub.listen("auth",e=>{const{payload:t}=e;(e=>{switch(e.event){case"signIn":r&&n(!0)}})(t)}),(async()=>{r&&a({type:"FETCH_USER_DATA_INIT"});try{if(r){const r=await e.Auth.currentAuthenticatedUser();r&&a({type:"FETCH_USER_DATA_SUCCESS",payload:{user:r}})}}catch(e){r&&a({type:"FETCH_USER_DATA_FAILURE"})}})(),()=>{e.Hub.remove("auth"),r=!1}},[u]);return{state:s,handleSignout:async()=>{try{await e.Auth.signOut(),n(!1),a({type:"RESET_USER_DATA"})}catch(r){console.error("Error signing out user ",r)}}}};
