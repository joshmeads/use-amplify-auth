const e=(e,r)=>{switch(r.type){case"FETCH_USER_DATA_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_USER_DATA_SUCCESS":return{...e,isLoading:!1,isError:!1,user:r.payload.user};case"FETCH_USER_DATA_FAILURE":return{...e,isLoading:!1,isError:!0};case"RESET_USER_DATA":return{...e,user:null};default:throw new Error}};export default r=>{Amplify.configure(r);const[t,s]=React.useReducer(e,{isLoading:!0,isError:!1,user:null}),[a,n]=React.useState(!1);React.useEffect(()=>{let e=!0;return Amplify.Hub.listen("auth",r=>{const{payload:t}=r;(r=>{switch(r.event){case"signIn":e&&n(!0)}})(t)}),(async()=>{e&&s({type:"FETCH_USER_DATA_INIT"});try{if(e){const e=await Amplify.Auth.currentAuthenticatedUser();e&&s({type:"FETCH_USER_DATA_SUCCESS",payload:{user:e}})}}catch(r){e&&s({type:"FETCH_USER_DATA_FAILURE"})}})(),()=>{Amplify.Hub.remove("auth"),e=!1}},[a]);return{state:t,handleSignout:async()=>{try{await Amplify.Auth.signOut(),n(!1),s({type:"RESET_USER_DATA"})}catch(e){console.error("Error signing out user ",e)}}}};
